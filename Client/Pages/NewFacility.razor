@using BlazorApp.Shared
@inject HttpClient Http

@page "/newfacility"
@attribute [Authorize(Roles = "admin")]

<EditForm Model="@facility" OnValidSubmit="@HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />
    <div class="form-group">
        <InputText class="form-control" placeholder="Название объекта" @bind-Value="facility.Name" />
    </div>
    <div class="form-group">
        <InputText class="form-control" placeholder="Адрес объекта" @bind-Value="facility.Address" />
    </div>
    <button type="submit" class="btn btn-primary">Создать</button>
</EditForm>

@code {
    private FacilityDto facility = new FacilityDto();

    private async Task HandleValidSubmit()
    {
        try
        {
            var result = await Http.PostAsJsonAsync<FacilityDto>("/api/NewFacility", facility);
        }
        catch(Exception ex)
        {
            Console.WriteLine(ex.ToString());
        }
    }
}
